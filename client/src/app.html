<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%sveltekit.assets%/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <meta name="google-site-verification" content="tLwSY-sCSyflthL65rzVskAXEYwvTDU5iV2QSrJLuO4" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    %sveltekit.head%

    <!-- âœ… DEBUG: Confirm this file is being used -->
    <script>
      console.log("âœ… app.html loaded");
    </script>

    <!-- âœ… Manual script injection for Privacy Analytics -->
    <script>
  console.log("ğŸ›°ï¸ Injecting Privacy Analytics script...");

  const js = document.createElement('script');
  js.src = 'https://rp-blond.vercel.app/api/tracking/script?id=468c460f-3b52-499c-b5b5-4ed91039f11a';
  js.async = true;

  js.onload = function () {
    console.log("âœ… Privacy Analytics script loaded");

    // Try multiple times to detect `pa` in case of async registration
    let attempts = 0;
    const maxAttempts = 5;
    const checkPa = () => {
      if (window.pa && typeof window.pa.track === 'function') {
        console.log("ğŸ“¡ Tracking pageview...");
        window.pa.track('pageview');
      } else {
        attempts++;
        if (attempts < maxAttempts) {
          console.warn(`âš ï¸ Privacy Analytics global \`pa\` not ready, retrying... (${attempts})`);
          setTimeout(checkPa, 200); // Retry after 200ms
        } else {
          console.error("âŒ Privacy Analytics global `pa` not defined or missing `track` method after retries");
          console.log("window.pa:", window.pa);
        }
      }
    };

    checkPa();
  };

  js.onerror = function () {
    console.error("âŒ Failed to load Privacy Analytics script");
  };

  document.head.appendChild(js);
</script>


  <script>
        console.log("ğŸš€ Sending test request to /api/test...");
      
        fetch("https://rp-blond.vercel.app/api/test", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ test: true })
        })
          .then(res => res.json())
          .then(data => {
            console.log("âœ… Test API response:", data);
          })
          .catch(err => {
            console.error("âŒ Test API call failed:", err);
          });
  </script>

  </head>

  <body data-sveltekit-preload-data="hover">
    <div style="display: contents">%sveltekit.body%</div>
  </body>
</html>
